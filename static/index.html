<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Randophy</title>
    <link rel="stylesheet" href="style.css">
    <meta name="description" content="Randophy est un site basé sur Spotify vous permettant de faire de la découverte musicale">
    <link rel="icon" href="https://i.ibb.co/CMVHm0Q/logo.png">
</head>

<body>
    <ul class="navbar">
        <li class="li-navbar"><a class="a-nav" href="index.html"><img class="logo" src="https://i.ibb.co/CMVHm0Q/logo.png">Randophy</a></li>
        <li><a class="a-nav" href="about.html">About</a></li>
        <li><a class="a-nav" href="settings.html">Settings</a></li>
        <li class="login_button"><a class="a-nav" href="/login">Login</a></li>
    </ul>

    <div class="centre">
        <h1>Welcome on Randophy!</h1>
        <div class="description">Randophy is a Spotify-based website for music discovery.</div>
        <div id="embed-iframe"></div>
        <script src="https://open.spotify.com/embed/iframe-api/v1" async></script>
        <script type="text/javascript">
            const id = "2oqj04vv8thnp5XbBexIsp";
            window.onSpotifyIframeApiReady = (IFrameAPI) => {
                const element = document.getElementById('embed-iframe');
                const options = {
                    width: '100%',
                    height: '160',
                    uri: 'spotify:track:' + id
                };
                const callback = (EmbedController) => {
                    document.querySelectorAll('.track').forEach(track => {
                        track.addEventListener('click', () => {
                            EmbedController.loadUri(track.dataset.spotifyId);
                        });
                    });
                    EmbedController.addListener('player_state_changed', state => {
                        if (state) {
                            const { position, duration } = state;
                            if (position === duration) {
                                console.log('La piste est terminée');
                            }
                        }
                    });
                };
                IFrameAPI.createController(element, options, callback);
            };
        </script>
    </div>
</body>

</html>
